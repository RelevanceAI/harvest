# Plan: Establish Plan Infrastructure for Autonomous Agent Workflow

**Phase**: Phase 0 (Rules & Infrastructure)  
**Branch**: `docs/phase-0-rules-finalization`  
**Created**: 2026-01-14 21:00  
**Status**: Awaiting Review

---

## Objective

Implement the plan storage and indexing infrastructure that enables autonomous agent development with clear approval gates and historical feedback loops.

---

## Problem Statement

Currently:
- Plans are scattered across the repo (MASTER_ACTION_PLAN.md at root, various docs/plans/*.md)
- No clear organization for multi-iteration planning (research → plan → implement)
- No timestamped tracking for debugging "which iteration am I on?"
- No indexing system to track active/completed/abandoned plans
- Cannot easily reference plans from PRs for approval gate workflow

This causes:
- Confusion about which plan is current
- Lost context between sessions
- No feedback loop artifacts from plan → implementation

---

## Solution

Create standardized plan infrastructure with timestamped files and clear indexing.

### Directory Structure
```
.claude/plans/
├── README.md (index + workflow guide)
└── docs-phase-0-rules-finalization/
    ├── research_2026-01-14_2100.md
    ├── plan_2026-01-14_2100.md
    └── implementation_2026-01-14_2200.md
```

**Branch Name → Directory Name Mapping**: Replace `/` with `-`
- Branch: `docs/phase-0-rules-finalization` → Dir: `docs-phase-0-rules-finalization`
- Branch: `feat/modal-sandbox-block-1.1` → Dir: `feat-modal-sandbox-block-1.1`

### Files to Create

#### `.claude/plans/README.md`
Content should explain:
1. **Directory Structure** - What `.claude/plans/` contains and why
2. **Timestamp Format** - `YYYY-MM-DD_HHMM` for sortability and clarity
3. **Three-Phase Workflow**:
   - Research: Understanding the problem, exploring solutions
   - Plan: Detailed implementation steps with success criteria
   - Implementation: Actual code changes, testing, validation
4. **Versioning Strategy** - How to handle revisions (via timestamps, not version numbers)
5. **How to Read a Plan** - What each section means, how to give feedback
6. **Index of Plans** - Active/completed/abandoned with PR links
7. **Link to This Plan** - Meta-reference showing the structure itself

#### `.claude/plans/docs-phase-0-rules-finalization/plan_2026-01-14_2100.md`
- This file (the meta-plan for setting up infrastructure)

---

## Implementation Steps

**Step 1: Create Directory Structure**
```bash
mkdir -p .claude/plans/docs-phase-0-rules-finalization
```

**Step 2: Create `.claude/plans/README.md`**

Template:
```markdown
# Plans Directory

## Overview
Plans are organized by branch name and tracked through three phases:
1. **Research** - Exploration and understanding
2. **Plan** - Detailed proposal with success criteria
3. **Implementation** - Code execution and validation

## Directory Structure
- `.claude/plans/[branch-name]/`
  - `research_YYYY-MM-DD_HHMM.md` - What we learned
  - `plan_YYYY-MM-DD_HHMM.md` - How we'll build it
  - `implementation_YYYY-MM-DD_HHMM.md` - What we actually built

## How to Read a Plan
- **Research**: Context, problem understanding, exploration of approaches
- **Plan**: Step-by-step implementation, success criteria, testing strategy
- **Implementation**: Code changes made, test results, lessons learned

## Index

### Active
- `docs-phase-0-rules-finalization/` - Plan Infrastructure Setup
  - Plan: [plan_2026-01-14_2100.md](docs-phase-0-rules-finalization/plan_2026-01-14_2100.md)
  - Status: Awaiting Review
  - PR: TBD

### Completed
(none yet)

### Abandoned
(none yet)
```

**Step 3: Commit and Create Plan PR**
```bash
git add .claude/plans/
git commit -m "docs(plans): establish timestamped plan infrastructure"
git push origin docs/phase-0-plan-infrastructure
```

**Step 4: Open PR**
- Base: `main`
- Head: `docs/phase-0-plan-infrastructure`
- Title: `[PLAN] Establish Plan Infrastructure for Autonomous Workflows`
- Description: Include link to plan file and brief rationale

---

## Success Criteria

- [ ] `.claude/plans/` directory created
- [ ] `.claude/plans/docs-phase-0-rules-finalization/` subdirectory created
- [ ] `.claude/plans/README.md` written with full explanation and index
- [ ] This plan file committed to `.claude/plans/docs-phase-0-rules-finalization/plan_2026-01-14_2100.md`
- [ ] PR opened with `phase-review-pending` label
- [ ] Timestamp format is sortable and unambiguous
- [ ] README clearly explains three-phase workflow

---

## Assumptions

1. Currently on `docs/phase-0-rules-finalization` branch
2. GitHub PR labels exist or can be auto-created
3. This infrastructure will be reused for all future phases
4. Human will review and approve before implementation proceeds

---

## Dependencies

- None (foundational infrastructure work)

---

## Testing Strategy

Manual verification:
1. Verify structure: `ls -la .claude/plans/`
2. Verify plan file committed: `git log --oneline -- .claude/plans/`
3. Verify README clarity: Read it and check for completeness
4. Verify PR created: Check GitHub PR dashboard with correct label

---

## Rollback Plan

If structure doesn't work:
1. `git revert` the commit
2. Delete `.claude/plans/`
3. Document lessons learned
4. Propose alternative approach

---

## Notes

**This is a Meta-Plan**
- It's establishing infrastructure for future plans, not solving a user problem directly
- Once approved, we use this structure for Phase 1.1 (Modal), Phase 1.2 (GitHub App), etc.
- Timestamps help me (the agent) track "which version am I reading?" across sessions
- Plans stay in git forever → create feedback loop artifact

**Why Branch Name in Directory**
- Each feature/phase gets its own isolated directory
- Branch name is the unique identifier
- Easier to find: `ls .claude/plans/` shows all active work

**Why Separate files (research, plan, implementation)**
- Research is about understanding - different skill set
- Plan is about design - needs approval
- Implementation is execution - can iterate independently
- Makes it easier to reference: "see the plan in docs-phase-0-rules-finalization/plan_*.md"

---

## Timeline

- Research phase: Completed (decided with user)
- Plan phase: THIS FILE (awaiting review)
- Implementation phase: After approval, will create README, commit files, open PR
- Approval gate: User ticks checkbox on plan PR
- Close plan PR: No merge, just close and move to Phase 1.1 planning

---

## Next Steps (After Approval)

1. ✅ Research: Completed
2. ⏳ Validate with Gemini: In progress
3. ⏳ Create this plan file: Done
4. ⏳ Create README.md file
5. ⏳ Commit and push to feature branch
6. ⏳ Open PR for approval
7. ⏳ Await approval (phase-review-pending)
8. ⏳ Close plan PR and proceed to Phase 1.1 planning
